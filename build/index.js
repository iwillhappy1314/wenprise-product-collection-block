(()=>{"use strict";const e=window.React,t=window.wp.components,n=window.wp.i18n,o=window.wp.element,l=window.wp.data;var a=[{name:"desktop",icon:"dashicons-desktop"},{name:"tablet",icon:"dashicons-tablet"},{name:"mobile",icon:"dashicons-smartphone"}],r={Desktop:"desktop",Tablet:"tablet",Mobile:"mobile"},i=function(t){var n=t.selectedDevice,o=t.onChange,l={padding:0,minWidth:"16px",height:"16px",background:"transparent",border:"none",cursor:"pointer"};return e.createElement("div",{className:"wprs-device-switcher",style:{display:"flex"}},a.map((function(t){return e.createElement("button",{key:t.name,style:l,onClick:function(){return o(t.name)}},e.createElement("span",{className:"dashicons ".concat(t.icon),style:{minWidth:"16px",height:"16px",fontSize:"16px",color:n===t.name?"#007cba":"#949494"}}))})))};const c=new Map,p={xhuge:1920,huge:1440,wide:1280,xlarge:1080,large:960,medium:782,small:600,mobile:480},s={">=":"min-width","<":"max-width"},u={">=":(e,t)=>t>=e,"<":(e,t)=>t<e},m=(0,o.createContext)(null),d=(e,t=">=")=>{const n=(0,o.useContext)(m),l=function(e){const t=(0,o.useMemo)((()=>{const t=function(e){if(!e)return null;let t=c.get(e);return t||("undefined"!=typeof window&&"function"==typeof window.matchMedia?(t=window.matchMedia(e),c.set(e,t),t):null)}(e);return{subscribe:e=>t?(t.addEventListener?.("change",e),()=>{t.removeEventListener?.("change",e)}):()=>{},getValue(){var e;return null!==(e=t?.matches)&&void 0!==e&&e}}}),[e]);return(0,o.useSyncExternalStore)(t.subscribe,t.getValue,(()=>!1))}(!n&&`(${s[t]}: ${p[e]}px)`||void 0);return n?u[t](p[e],n):l};d.__experimentalWidthProvider=m.Provider;var w=d,g=function(){var e=(0,o.useState)("desktop"),t=e[0],n=e[1],a=w("medium","<"),i=w("small","<");return(0,o.useEffect)((function(){n(i?"mobile":a?"tablet":"desktop")}),[a,i]),(0,o.useEffect)((function(){var e=(0,l.subscribe)((function(){try{var e=(0,l.select)("core/edit-post");if(e&&"function"==typeof e.__experimentalGetPreviewDeviceType){var t=e.__experimentalGetPreviewDeviceType();t&&r[t]&&n(r[t])}}catch(e){console.error("Failed to get preview device type:",e)}}));return function(){return e()}}),[]),{device:t,handleDeviceChange:function(e){n(e);try{var t=(0,l.dispatch)("core/edit-post");t&&"function"==typeof t.__experimentalSetPreviewDeviceType&&t.__experimentalSetPreviewDeviceType({desktop:"Desktop",tablet:"Tablet",mobile:"Mobile"}[e])}catch(e){console.error("Failed to set preview device type:",e)}}}},b=function(o){var l=o.attributes,a=o.setAttributes,r=g(),c=r.device,p=r.handleDeviceChange,s=l.perPage,u=l.perPageTablet,m=l.perPageMobile,d=l.gap,w=l.gapTablet,b=l.gapMobile,y=l.pagination,C=l.arrows;return e.createElement(t.PanelBody,{title:(0,n.__)("Carousel Settings","wenprise-wp-components"),initialOpen:!0},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"}},e.createElement("label",{style:{minWidth:"100px"}},(0,n.__)("Items Per Page","wenprise-wp-components")),e.createElement(i,{selectedDevice:c,onChange:p})),"desktop"===c&&e.createElement(t.RangeControl,{value:s,onChange:function(e){return a({perPage:e})},min:1,max:8}),"tablet"===c&&e.createElement(t.RangeControl,{value:u,onChange:function(e){return a({perPageTablet:e})},min:1,max:6}),"mobile"===c&&e.createElement(t.RangeControl,{value:m,onChange:function(e){return a({perPageMobile:e})},min:1,max:4}),e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"}},e.createElement("label",{style:{minWidth:"100px"}},(0,n.__)("Gap","wenprise-wp-components")),e.createElement(i,{selectedDevice:c,onChange:p})),"desktop"===c&&e.createElement(t.TextControl,{value:d,onChange:function(e){return a({gap:e})},help:(0,n.__)("Supports units like rem, em, px, etc. Example: 2rem","wenprise-wp-components")}),"tablet"===c&&e.createElement(t.TextControl,{value:w,onChange:function(e){return a({gapTablet:e})},help:(0,n.__)("Supports units like rem, em, px, etc. Example: 2rem","wenprise-wp-components")}),"mobile"===c&&e.createElement(t.TextControl,{value:b,onChange:function(e){return a({gapMobile:e})},help:(0,n.__)("Supports units like rem, em, px, etc. Example: 2rem","wenprise-wp-components")}),e.createElement(t.ToggleControl,{label:(0,n.__)("Show Pagination","wenprise-wp-components"),checked:y,onChange:function(e){return a({pagination:e})}}),e.createElement(t.ToggleControl,{label:(0,n.__)("Show Arrows","wenprise-wp-components"),checked:C,onChange:function(e){return a({arrows:e})}}))},y=function(o){var l=o.attributes,a=o.setAttributes,r=g(),c=r.device,p=r.handleDeviceChange,s=l.columns,u=l.tabletColumns,m=l.mobileColumns,d=l.columnGap,w=l.tabletColumnGap,b=l.mobileColumnGap,y=l.rowGap,C=l.tabletRowGap,f=l.mobileRowGap,v=l.productsCount;return e.createElement(t.PanelBody,{title:(0,n.__)("Layout Settings","wenprise-wp-components"),initialOpen:"carousel"!==l.displayStyle},e.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"}},e.createElement("label",{style:{minWidth:"100px"}},(0,n.__)("Device","wenprise-wp-components")),e.createElement(i,{selectedDevice:c,onChange:p})),"desktop"===c&&e.createElement(e.Fragment,null,e.createElement(t.RangeControl,{label:(0,n.__)("Columns","wenprise-wp-components"),value:s,onChange:function(e){return a({columns:e})},min:1,max:6}),e.createElement(t.RangeControl,{label:(0,n.__)("Column Gap","wenprise-wp-components")+" (px)",value:d,onChange:function(e){return a({columnGap:e})},min:0,max:100}),e.createElement(t.RangeControl,{label:(0,n.__)("Row Gap","wenprise-wp-components")+" (px)",value:y,onChange:function(e){return a({rowGap:e})},min:0,max:100})),"tablet"===c&&e.createElement(e.Fragment,null,e.createElement(t.RangeControl,{label:(0,n.__)("Columns","wenprise-wp-components"),value:u,onChange:function(e){return a({tabletColumns:e})},min:1,max:4}),e.createElement(t.RangeControl,{label:(0,n.__)("Column Gap","wenprise-wp-components")+" (px)",value:w,onChange:function(e){return a({tabletColumnGap:e})},min:0,max:80}),e.createElement(t.RangeControl,{label:(0,n.__)("Row Gap","wenprise-wp-components")+" (px)",value:C,onChange:function(e){return a({tabletRowGap:e})},min:0,max:80})),"mobile"===c&&e.createElement(e.Fragment,null,e.createElement(t.RangeControl,{label:(0,n.__)("Columns","wenprise-wp-components"),value:m,onChange:function(e){return a({mobileColumns:e})},min:1,max:2}),e.createElement(t.RangeControl,{label:(0,n.__)("Column Gap","wenprise-wp-components")+" (px)",value:b,onChange:function(e){return a({mobileColumnGap:e})},min:0,max:50}),e.createElement(t.RangeControl,{label:(0,n.__)("Row Gap","wenprise-wp-components")+" (px)",value:f,onChange:function(e){return a({mobileRowGap:e})},min:0,max:50})),e.createElement(t.RangeControl,{label:(0,n.__)("Products Count","wenprise-wp-components"),value:v,onChange:function(e){return a({productsCount:e})},min:1,max:48}))};const C=window.ReactJSXRuntime,{registerBlockType:f}=wp.blocks,{InspectorControls:v}=wp.blockEditor,{PanelBody:h,SelectControl:x}=wp.components,{useState:_,useEffect:E}=wp.element,{apiFetch:P}=wp,{__}=wp.i18n,S=wp.serverSideRender;f("wenprise/product-collection",{title:__("Product Collection","wenprise-product-collection"),icon:"grid-view",category:"wenprise-blocks",attributes:{taxonomyType:{type:"string",default:"product_tag"},tagId:{type:"string",default:""},displayStyle:{type:"string",default:"grid"},columns:{type:"number",default:4},tabletColumns:{type:"number",default:3},mobileColumns:{type:"number",default:2},columnGap:{type:"number",default:32},tabletColumnGap:{type:"number",default:24},mobileColumnGap:{type:"number",default:16},rowGap:{type:"number",default:32},tabletRowGap:{type:"number",default:24},mobileRowGap:{type:"number",default:16},productsCount:{type:"number",default:12},perPage:{type:"number",default:4},perPageTablet:{type:"number",default:2},perPageMobile:{type:"number",default:1},gap:{type:"string",default:"2rem"},gapTablet:{type:"string",default:"1.5rem"},gapMobile:{type:"string",default:"1rem"},pagination:{type:"boolean",default:!0},arrows:{type:"boolean",default:!0}},edit:function(e){const{attributes:t,setAttributes:n}=e,[o,l]=_([]),[a,r]=_(!1),i=[{label:__("Product Tags","wenprise-product-collection"),value:"product_tag"},{label:__("Product Categories","wenprise-product-collection"),value:"product_cat"},{label:__("Product Collections","wenprise-product-collection"),value:"product_collection"}],c={product_tag:__("Tag","wenprise-product-collection"),product_cat:__("Category","wenprise-product-collection"),product_collection:__("Collection","wenprise-product-collection")};E((()=>{t.taxonomyType&&p(t.taxonomyType)}),[t.taxonomyType]);const p=async e=>{r(!0);try{const t=(await P({path:`/wp/v2/${e}?per_page=100`})).map((e=>({label:e.name,value:e.id.toString()})));l(t)}catch(e){console.error("Error loading taxonomy terms:",e),l([])}r(!1)};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(v,{children:[(0,C.jsxs)(h,{title:__("区块设置","wenprise-product-collection"),children:[(0,C.jsx)(x,{label:__("Select Taxonomy","wenprise-product-collection"),value:t.taxonomyType,options:i,onChange:e=>{n({taxonomyType:e,tagId:""})}}),(0,C.jsx)(x,{label:__("Select","wenprise-product-collection")+" "+c[t.taxonomyType],value:t.tagId,options:[{label:__("Please select","wenprise-product-collection"),value:""},...o],onChange:e=>n({tagId:e})})]}),(0,C.jsx)(h,{title:__("显示样式","wenprise-product-collection"),children:(0,C.jsx)(x,{label:__("显示样式","wenprise-product-collection"),value:t.displayStyle,options:[{value:"grid",label:__("网格","wenprise-product-collection")},{value:"list",label:__("列表","wenprise-product-collection")},{value:"carousel",label:__("轮播","wenprise-product-collection")}],onChange:e=>n({displayStyle:e})})}),"carousel"===t.displayStyle&&(0,C.jsx)(b,{attributes:t,setAttributes:n}),("grid"===t.displayStyle||"list"===t.displayStyle)&&(0,C.jsx)(y,{attributes:t,setAttributes:n})]}),(0,C.jsx)("div",{className:`wc-block-product-collection wc-block-product-collection--${t.displayStyle}`,children:a?(0,C.jsx)("p",{children:__("Loading...","wenprise-product-collection")}):t.tagId?(0,C.jsx)(S,{block:"wenprise/product-collection",attributes:t}):(0,C.jsx)("p",{children:__("Please select a term in the sidebar settings","wenprise-product-collection")})})]})},save:function(){return null}})})();